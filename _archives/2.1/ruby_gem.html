---
layout: side-by-side
title: Ruby Gem
---
<ul class="jump_to">
<li> Jump To: </li>
  <li><a class="source" href="ajax.html">ajax.js</a></li>
  <li><a class="source" href="boot.html">boot.js</a></li>
  <li><a class="source" href="custom_boot.html">custom_boot.js</a></li>
  <li><a class="source" href="custom_equality.html">custom_equality.js</a></li>
  <li><a class="source" href="custom_matcher.html">custom_matcher.js</a></li>
  <li><a class="source" href="custom_reporter.html">custom_reporter.js</a></li>
  <li><a class="source" href="focused_specs.html">focused_specs.js</a></li>
  <li><a class="source" href="introduction.html">introduction.js</a></li>
  <li><a class="source" href="node.html">node.js</a></li>
  <li><a class="source" href="python_egg.html">python_egg.py</a></li>
  <li><a class="source" href="ruby_gem.html">ruby_gem.rb</a></li>
  <li><a class="source" href="upgrading.html">upgrading.js</a></li>
</ul>
<table cellspacing="0" cellpadding="0">
  <thead>
  <tr>
    <th class="docs">
      <h1>ruby_gem.rb</h1>
    </th>
    <th class="code"></th>
  </tr>
  </thead>
  <tbody>
  <tr id="section-Using_jasmine_with_ruby">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-Using_jasmine_with_ruby">&#182;</a>
      </div>
      <h1>Using jasmine with ruby</h1>

<p>The jasmine gem can be use both with and without Rails.</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre><span></span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-2">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-2">&#182;</a>
      </div>
      <p>Add the jasmine gem to your gemfile and <code>bundle install</code></p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre><span class="n">gem</span> <span class="s1">&#39;jasmine&#39;</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-Setup">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-Setup">&#182;</a>
      </div>
      <h2>Setup</h2>

<p>To install a default jasmine.yml and a sample jasmine_helper.rb</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre></pre>
      </div>
    </td>
  </tr>
  <tr id="section-4">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-4">&#182;</a>
      </div>
      <p>If your project is using Rails, jasmine has generators you can use to get everything set up.</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre><span class="n">rails</span> <span class="n">g</span> <span class="ss">jasmine</span><span class="p">:</span><span class="n">install</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-5">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-5">&#182;</a>
      </div>
      <p>If your project doesn&#39;t use Rails, all of these commands also exist in the command line tool <code>jasmine</code>.
The command line tool will also modify your Rakefile to load the jasmine tasks</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre><span class="n">jasmine</span> <span class="n">init</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-6">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-6">&#182;</a>
      </div>
      <p>Jasmine also has some example specs, with implementation, that you can install.</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre><span class="n">rails</span> <span class="n">g</span> <span class="ss">jasmine</span><span class="p">:</span><span class="n">examples</span>
<span class="n">jasmine</span> <span class="n">examples</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-Use">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-Use">&#182;</a>
      </div>
      <h2>Use</h2>

<p>Once you&#39;ve installed your <code>jasmine.yml</code> two commands will be available to you in <code>rake</code>.</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre></pre>
      </div>
    </td>
  </tr>
  <tr id="section-8">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-8">&#182;</a>
      </div>
      <p>If you want to start a server that continues to run so you can point a browser at it</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre><span class="n">rake</span> <span class="n">jasmine</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-9">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-9">&#182;</a>
      </div>
      <p>For use on your CI server</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre><span class="n">rake</span> <span class="ss">jasmine</span><span class="p">:</span><span class="n">ci</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-Configuration">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-Configuration">&#182;</a>
      </div>
      <h2>Configuration</h2>

<p>Primary configuration is done in <code>jasmine.yml</code>, which is in <code>spec/javascripts/support</code> by default.
<code>jasmine.yml</code> has configuration on what files should be loaded on the page running tests as well as the location of a ruby file to be loaded for more complex configuration, demonstrated below:</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre></pre>
      </div>
    </td>
  </tr>
  <tr id="section-11">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-11">&#182;</a>
      </div>
      <p>The <code>jasmine_helper.rb</code> file specified by the <code>spec_helper</code> key in <code>jasmine.yml</code> consists of a configure block.</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre><span class="no">Jasmine</span><span class="o">.</span><span class="n">configure</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-12">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-12">&#182;</a>
      </div>
      <p>You can add rack handlers for specific urls</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre>  <span class="n">config</span><span class="o">.</span><span class="n">add_rack_path</span> <span class="s1">&#39;/something&#39;</span> <span class="k">do</span>
  <span class="o">[</span><span class="mi">200</span><span class="o">]</span>
<span class="k">end</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-13">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-13">&#182;</a>
      </div>
      <p>And mount other rack applications</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre>  <span class="n">config</span><span class="o">.</span><span class="n">add_rack_app</span> <span class="no">MyRackApp</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-14">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-14">&#182;</a>
      </div>
      <p>You can configure the port that the <code>rake jasmine</code> command starts a server on</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre>  <span class="n">config</span><span class="o">.</span><span class="n">server_port</span> <span class="o">=</span> <span class="mi">12345</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-15">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-15">&#182;</a>
      </div>
      <p>You can configure the port that the <code>rake jasmine:ci</code> command starts it&#39;s server on</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre>  <span class="n">config</span><span class="o">.</span><span class="n">ci_port</span> <span class="o">=</span> <span class="mi">54321</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-16">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-16">&#182;</a>
      </div>
      <p>You can add <a href="#section-Custom_Formatters">custom formatters</a></p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre>  <span class="n">config</span><span class="o">.</span><span class="n">formatters</span> <span class="o">&lt;&lt;</span> <span class="no">My</span><span class="o">::</span><span class="no">Custom</span><span class="o">::</span><span class="no">Formatter</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-17">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-17">&#182;</a>
      </div>
      <p>You can use a <a href="#section-Custom_Runners">custom runner</a>
The <code>runner</code> option on config should be a lambda or Proc that receives a formatter and server url and returns a constructed runner object.
The lambda allows you to configure other options that need to be configured at initialization time.</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre>  <span class="n">config</span><span class="o">.</span><span class="n">runner</span> <span class="o">=</span> <span class="nb">lambda</span> <span class="p">{</span> <span class="o">|</span><span class="n">formatter</span><span class="p">,</span> <span class="n">server_url</span><span class="o">|</span> <span class="no">My</span><span class="o">::</span><span class="no">Custom</span><span class="o">::</span><span class="no">Runner</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">formatter</span><span class="p">,</span> <span class="n">server_url</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-Configuring_the_default_phantomjs_runner">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-Configuring_the_default_phantomjs_runner">&#182;</a>
      </div>
      <h3>Configuring the default phantomjs runner</h3>

<p>The phantomjs runner supports some additional options.</p>

<p>If you want to see the output from <code>console.log</code> messages from your specs, set show<em>console</em>log to true.</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre><span class="ss">show_console_log</span><span class="p">:</span> <span class="kp">true</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-19">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-19">&#182;</a>
      </div>
      <p>If you need to configure the phantomjs webpage object, you can specify a config script.</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre><span class="ss">phantom_config_script</span><span class="p">:</span> <span class="s1">&#39;relative/path/from/project/root.js&#39;</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-20">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-20">&#182;</a>
      </div>
      <p>This file will be <code>require</code>d by the phantom runner and the <code>configure</code> function will be passed the constructed <code>page</code> object.</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre><span class="n">exports</span><span class="o">.</span><span class="n">configure</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">page</span><span class="p">)</span> <span class="p">{</span>
<span class="n">page</span><span class="o">.</span><span class="n">viewportSize</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">width</span><span class="p">:</span> <span class="mi">340</span><span class="p">,</span>
  <span class="ss">height</span><span class="p">:</span> <span class="mi">220</span>
<span class="p">};</span>
<span class="p">};</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-Custom_Formatters">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-Custom_Formatters">&#182;</a>
      </div>
      <h2>Custom Formatters</h2>

<p>By default the <code>jasmine:ci</code> rake task outputs <code>.</code>s, <code>F</code>s, and <code>*</code>s as the specs run and a summary at the end.
If you want to change the output, or produce some other output, you&#39;ll want a custom formatter.
For an example of how to add your custom formatter see the <a href="#section-Configuration">configuration section</a></p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre></pre>
      </div>
    </td>
  </tr>
  <tr id="section-22">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-22">&#182;</a>
      </div>
      <p>Your custom formatter must implement 2 methods, <code>format</code> and <code>done</code></p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre><span class="k">class</span> <span class="nc">My</span><span class="o">::</span><span class="no">Custom</span><span class="o">::</span><span class="no">Formatter</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-23">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-23">&#182;</a>
      </div>
      <p><code>format</code> is called by the runner every time it gets a batch of results from the page.
The parameter will be an array of <code>Jasmine::Result</code> objects</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre>  <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
  <span class="n">results</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">result</span><span class="o">|</span>
    <span class="nb">puts</span> <span class="n">result</span><span class="o">.</span><span class="n">status</span>
  <span class="k">end</span>
<span class="k">end</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-24">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-24">&#182;</a>
      </div>
      <p><code>done</code> will be called by the runner after all results have come in.</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre>  <span class="k">def</span> <span class="nf">done</span>
  <span class="nb">puts</span> <span class="s1">&#39;Done running tests&#39;</span>
<span class="k">end</span>
<span class="k">end</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-25">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-25">&#182;</a>
      </div>
      <p>The jasmine team also maintains a custom formatter that produces junit style XML for use on a CI server that knows how to parse it.
<a href="https://github.com/jasmine/jasmine_junitxml_formatter">Jasmine JUnit XML Formatter</a></p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre></pre>
      </div>
    </td>
  </tr>
  <tr id="section-Custom_Runners">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-Custom_Runners">&#182;</a>
      </div>
      <h2>Custom Runners</h2>

<p>By default the <code>jasmine:ci</code> rake task uses phantomjs to load the jasmine spec runner page and run the tests.
If you want to run your tests with a different browser, or change how phantom is used, you&#39;ll want a custom runner.
For an example of how to add your custom runner see the <a href="#section-Configuration">configuration section</a></p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre></pre>
      </div>
    </td>
  </tr>
  <tr id="section-27">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-27">&#182;</a>
      </div>
      <p>Once constructed, a runner only needs to implement a <code>run</code> method</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre><span class="k">class</span> <span class="nc">My</span><span class="o">::</span><span class="no">Custom</span><span class="o">::</span><span class="no">Runner</span>
<span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">formatter</span><span class="p">,</span> <span class="n">jasmine_server_url</span><span class="p">,</span> <span class="n">result_batch_size</span><span class="p">)</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-28">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-28">&#182;</a>
      </div>
      <p>The formatter passed in is responsible for making sure all configured formatters receive the same messages.</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre>    <span class="vi">@formatter</span> <span class="o">=</span> <span class="n">formatter</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-29">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-29">&#182;</a>
      </div>
      <p>The <code>jasmine_server_url</code> is the full http://&lt;host&gt;:&lt;port&gt; url where the jasmine server was started</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre>    <span class="vi">@jasmine_server_url</span> <span class="o">=</span> <span class="n">jasmine_server_url</span>
  <span class="vi">@result_batch_size</span> <span class="o">=</span> <span class="n">result_batch_size</span>
<span class="k">end</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-30">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-30">&#182;</a>
      </div>
      <p><code>run</code> is responsible coordinating the test run.</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre>  <span class="k">def</span> <span class="nf">run</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-31">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-31">&#182;</a>
      </div>
      <p>Here we&#39;re using Phantom to load the page and run the specs</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre>    <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="no">Phantomjs</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2"> &#39;phantom_jasmine_run.js&#39; </span><span class="si">#{</span><span class="vi">@jasmine_server_url</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="vi">@result_batch_size</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="no">IO</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="n">command</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">output</span><span class="o">|</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-32">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-32">&#182;</a>
      </div>
      <p>The <code>phantom_jasmine_run.js</code> script writes out batches of results as JSON</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre>      <span class="n">output</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">line</span><span class="o">|</span>
      <span class="n">raw_results</span> <span class="o">=</span> <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="ss">:max_nesting</span> <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">)</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-33">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-33">&#182;</a>
      </div>
      <p>Formatters expect to get <code>Jasmine::Result</code> objects.
It is the runner&#39;s job to convert the result objects from the page, and pass them to the <code>format</code> method of their formatter.</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre>        <span class="n">results</span> <span class="o">=</span> <span class="n">raw_results</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">r</span><span class="o">|</span> <span class="no">Result</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="p">}</span>
      <span class="vi">@formatter</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-34">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-34">&#182;</a>
      </div>
      <p>When the tests have finished, call <code>done</code> on the formatter to run any necessary completion logic.</p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre>    <span class="vi">@formatter</span><span class="o">.</span><span class="n">done</span>
<span class="k">end</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-35">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-35">&#182;</a>
      </div>
      <p>If the runner needs some javascript to be loaded into the page as part of the load, it returns the full path in <code>boot_js</code></p>
    </td>
    <td class="code">
      <div class="highlight">
        <pre>  <span class="k">def</span> <span class="nf">boot_js</span>
  <span class="no">File</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="s1">&#39;runner_boot.js&#39;</span><span class="p">,</span> <span class="bp">__FILE__</span><span class="p">)</span>
<span class="k">end</span>
<span class="k">end</span></pre>
      </div>
    </td>
  </tr>
  <tr id="section-36">
    <td class="docs">
      <div class="pilwrap">
        <a class="pilcrow" href="#section-36">&#182;</a>
      </div>
      <p>The jasmine team also maintains a custom runner that uses selenium (and optionally SauceLabs) to run your specs with other browsers.
<a href="https://github.com/jasmine/jasmine_selenium_runner">Jasmine Selenium Runner</a></p>

    </td>
    <td class="code">
      <div class="highlight">
        <pre></pre>
      </div>
    </td>
  </tr>
  </tbody>
</table>
